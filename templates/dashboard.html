{{define "content"}}
<style>
    .dashboard-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 20px; }
    .stat-card { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 12px; }
    .stat-card.green { background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%); }
    .stat-card.orange { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); }
    .stat-card.yellow { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); }
    .stat-card h3 { font-size: 14px; margin-bottom: 10px; opacity: 0.9; }
    .stat-card .value { font-size: 32px; font-weight: bold; }
    .quick-actions { display: flex; gap: 10px; flex-wrap: wrap; margin-bottom: 20px; }
    .quick-btn { padding: 12px 24px; background: #2ecc71; color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 14px; }
    .quick-btn:hover { background: #27ae60; }
    .quick-btn.secondary { background: #3498db; }
    .quick-btn.secondary:hover { background: #2980b9; }
    .chart-container { background: white; padding: 20px; border-radius: 12px; margin-bottom: 20px; }
    .chart-placeholder { height: 200px; background: #f8f9fa; border-radius: 8px; display: flex; align-items: center; justify-content: center; color: #999; }
</style>

<div class="dashboard-header" style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
    <div>
        <h2 style="margin: 0;">ğŸ“Š Dashboard</h2>
        <p style="color: #666; margin: 5px 0 0 0;">{{.Shop.Name}}</p>
    </div>
    <div>
        <span style="background: #d4edda; color: #155724; padding: 5px 12px; border-radius: 20px; font-size: 12px;">ğŸŸ¢ Online</span>
    </div>
</div>

<div class="quick-actions">
    <button class="quick-btn" onclick="location.href='/products/{{.Shop.ID}}'">ğŸ“¦ Products</button>
    <button class="quick-btn" onclick="location.href='/sales/{{.Shop.ID}}'">ğŸ’° Sales</button>
    <button class="quick-btn secondary">ğŸ“Š Reports</button>
    <button class="quick-btn secondary">âš™ï¸ Settings</button>
</div>

<div class="dashboard-grid">
    <div class="stat-card green">
        <h3>ğŸ’° Today's Sales</h3>
        <div class="value">KSh {{.TotalSales}}</div>
    </div>
    <div class="stat-card">
        <h3>ğŸ“ˆ Total Profit</h3>
        <div class="value">KSh {{.TotalProfit}}</div>
    </div>
    <div class="stat-card orange">
        <h3>ğŸ§¾ Transactions</h3>
        <div class="value">{{.SaleCount}}</div>
    </div>
    <div class="stat-card yellow">
        <h3>ğŸ“¦ Products</h3>
        <div class="value">{{.ProductCount}}</div>
    </div>
</div>

{{if gt .LowStockCount 0}}
<div class="card" style="border-left: 4px solid #e74c3c;">
    <h3 style="color: #e74c3c; margin-bottom: 15px;">âš ï¸ Low Stock Alert ({{.LowStockCount}} items)</h3>
    <table>
        <thead>
            <tr>
                <th>Product</th>
                <th>Current Stock</th>
                <th>Threshold</th>
                <th>Status</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            {{range .LowStock}}
            <tr>
                <td>{{.Name}}</td>
                <td><span style="color: #e74c3c; font-weight: bold;">{{.CurrentStock}}</span></td>
                <td>{{.LowStockThreshold}}</td>
                <td><span class="badge badge-danger">Low</span></td>
                <td><button style="padding: 4px 8px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">Restock</button></td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>
{{end}}

<div class="card">
    <h3 style="margin-bottom: 15px;">ğŸ“ˆ Sales Trend (Last 7 Days)</h3>
    <div class="chart-container">
        <div class="chart-placeholder">
            ğŸ“Š Chart visualization would appear here<br>
            (Integrate with Chart.js for live charts)
        </div>
    </div>
</div>

<div class="dashboard-grid" style="grid-template-columns: 1fr 1fr;">
    <div class="card">
        <h3 style="margin-bottom: 15px;">ğŸ›’ Recent Sales</h3>
        {{if .Sales}}
        <table>
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Qty</th>
                    <th>Amount</th>
                    <th>Time</th>
                </tr>
            </thead>
            <tbody>
                {{range .Sales}}
                <tr>
                    <td>{{.Product.Name}}</td>
                    <td>{{.Quantity}}</td>
                    <td>KSh {{.TotalAmount}}</td>
                    <td>{{.CreatedAt.Format "15:04"}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{else}}
        <p style="color: #666; text-align: center; padding: 20px;">No sales today yet.</p>
        {{end}}
    </div>

    <div class="card">
        <h3 style="margin-bottom: 15px;">ğŸ“‹ Quick Stats</h3>
        <div style="padding: 20px;">
            <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                <span>Avg. Transaction</span>
                <strong>{{if gt .SaleCount 0}}KSh {{divf .TotalSales .SaleCount}}{{else}}KSh 0{{end}}</strong>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                <span>Profit Margin</span>
                <strong>{{if gt .TotalSales 0}}{{printf "%.1f" (mul (divf .TotalProfit .TotalSales) 100)}}%{{else}}0%{{end}}</strong>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #eee;">
                <span>Low Stock Items</span>
                <strong style="color: {{if gt .LowStockCount 0}}#e74c3c{{else}}#27ae60{{end}}">{{.LowStockCount}}</strong>
            </div>
            <div style="display: flex; justify-content: space-between; padding: 10px 0;">
                <span>Shop Plan</span>
                <strong>{{.Shop.Plan}}</strong>
            </div>
        </div>
    </div>
</div>

<div class="card" style="background: #f8f9fa; text-align: center;">
    <p style="color: #666; margin: 0;">
        ğŸ’¡ Tip: Use WhatsApp to manage your shop! Send commands like <code>add</code>, <code>sell</code>, <code>report</code>
    </p>
</div>
{{end}}
